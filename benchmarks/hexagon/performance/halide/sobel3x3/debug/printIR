#!/bin/bash

basedir=`dirname $0`
cd $basedir
. ../../setup-env.sh
set -x

rm -fr tmp ir
mkdir tmp
mkdir ir

g++ --std=c++11  -DLOG2VLEN=7 -DRUN=1 -DASSEMBLY=1 -DBITCODE=1 -I /home/maaz/Desktop/Research/rake/halide/distrib/include -I /home/maaz/Desktop/Research/rake/halide/distrib/tools -fno-rtti -O3 -g src/sobel_generator.cpp $HALIDE_ROOT/tools/GenGen.cpp -L/home/maaz/Desktop/Research/rake/halide/distrib/lib  -lHalide -o tmp/sobel_generator -ldl -lpthread -lz  -lz -lrt -ltinfo

g++ --std=c++11  -DLOG2VLEN=7 -DRUN=1 -DASSEMBLY=1 -DBITCODE=1 -I /home/maaz/Desktop/Research/rake/halide/distrib/include -I /home/maaz/Desktop/Research/rake/halide/distrib/tools -fno-rtti -O3 -g src/sobel_simple_generator.cpp $HALIDE_ROOT/tools/GenGen.cpp -L/home/maaz/Desktop/Research/rake/halide/distrib/lib  -lHalide -o tmp/sobel_simple_generator -ldl -lpthread -lz  -lz -lrt -ltinfo

export LD_LIBRARY_PATH=$HALIDE_ROOT/lib:; (./tmp/sobel_simple_generator -o tmp -e o,h,assembly,bitcode -g sobel -f sobel_hvx64 target=hexagon-32-noos-no_bounds_query-no_asserts-hvx_64) &> ir/sobel_simple_hvx64.ir
export LD_LIBRARY_PATH=$HALIDE_ROOT/lib:; (./tmp/sobel_generator -o tmp -e o,h,assembly,bitcode -g sobel -f sobel_hvx128 target=hexagon-32-noos-no_bounds_query-no_asserts-hvx_128) &> ir/sobel_simple_hvx128.ir

export LD_LIBRARY_PATH=$HALIDE_ROOT/lib:; (./tmp/sobel_generator -o tmp -e o,h,assembly,bitcode -g sobel -f sobel_hvx64 target=hexagon-32-noos-no_bounds_query-no_asserts-hvx_64) &> ir/sobel_hvx64.ir
export LD_LIBRARY_PATH=$HALIDE_ROOT/lib:; (./tmp/sobel_generator -o tmp -e o,h,assembly,bitcode -g sobel -f sobel_hvx128 target=hexagon-32-noos-no_bounds_query-no_asserts-hvx_128) &> ir/sobel_hvx128.ir

rm -fr tmp